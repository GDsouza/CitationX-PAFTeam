<?xml version="1.0" encoding="ISO-8859-1"?>

<PropertyList>

<!-- ====== FD enable ====== -->

		<logic>
       <name>FD enable</name>
       <input>
         <greater-than>
           <property>position/altitude-agl-ft</property>
           <value>50</value>
         </greater-than>
       </input>
       <output>autopilot/locks/FD-status</output>
		</logic>

		<logic>
       <name>FD bars shown</name>
       <input>
         <and>
           <property>autopilot/locks/FD-status</property>
           <or>
             <not>
               <equals>
                 <property>/autopilot/locks/heading</property>
                 <value>ROLL</value>
               </equals>
             </not>
             <not>
               <equals>
                 <property>/autopilot/locks/altitude</property>
                 <value>PTCH</value>
               </equals>
             </not>
           </or>
         </and>
       </input>
       <output>autopilot/internal/show-bars</output>
		</logic>


<!-- ======  Lateral Modes  ====== -->

    <filter>
      <name>nav heading error</name>
      <debug>false</debug>
      <type>gain</type>
      <gain>1.0</gain>
      <input>
        <condition>
          <or>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV1</value>
            </equals>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>FMS1</value>
            </equals>
          </or>
        </condition>
        <property>instrumentation/nav/radials/target-auto-hdg-deg</property>
      </input>
      <input>
        <condition>
          <or>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV2</value>
            </equals>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>FMS2</value>
            </equals>
          </or>
        </condition>
        <property>instrumentation/nav[1]/radials/target-auto-hdg-deg</property>
      </input>
      <reference>orientation/heading-deg</reference>
      <output>autopilot/internal/nav-heading-error-deg</output>
      <period>
        <min>-180</min>
        <max>180</max>
      </period>
    </filter>

    <filter>
      <name>heading deflection</name>
      <debug>false</debug>
      <type>gain</type>
      <gain>1.0</gain>
      <input>
        <condition>
          <or>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV1</value>
            </equals>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>FMS1</value>
            </equals>
          </or>
        </condition>
        <property>instrumentation/nav/heading-needle-deflection</property>
      </input>
      <input>
        <condition>
          <or>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV2</value>
            </equals>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>FMS2</value>
            </equals>
          </or>
        </condition>
        <property>instrumentation/nav[1]/heading-needle-deflection</property>
      </input>
      <reference>0</reference>
      <output>autopilot/internal/heading-deflection-deg</output>
      <period>
        <min>-180</min>
        <max>180</max>
      </period>
    </filter>

    <filter>
      <name>Course offset</name>
      <debug>false</debug>
      <type>gain</type>
      <gain>1.0</gain>
      <enable>
        <condition>
          <or>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV1</value>
            </equals>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV2</value>
            </equals>
          </or>
        </condition>
      </enable>
      <input>
        <condition>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV1</value>
            </equals>
        </condition>
        <property>instrumentation/nav/radials/sel-deg-corr</property>
      </input>
      <input>
        <condition>
          <equals>
            <property>autopilot/settings/nav-source</property>
            <value>NAV2</value>
          </equals>
        </condition>
        <property>instrumentation/nav[1]/radials/sel-deg-corr</property>
      </input>
      <reference>orientation/heading-deg</reference>
      <output>
        <condition>
          <not>
            <property>autopilot/back-course</property>
          </not>
        </condition>
          <property>autopilot/internal/course-offset</property>
      </output>
      <output>
        <condition>
          <property>autopilot/back-course</property>
        </condition>
          <property>autopilot/internal/course-offset</property>
          <scale>-1</scale>
      </output>
      <period>
        <min>-180</min>
        <max>180</max>
      </period>
    </filter>

    <filter>
      <name>Course deflection</name>
      <debug>false</debug>
      <type>gain</type>
      <gain>1.0</gain>
      <enable>
        <condition>
          <or>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV1</value>
            </equals>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV2</value>
            </equals>
          </or>
        </condition>
      </enable>
      <input>
        <condition>
          <and>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV1</value>
            </equals>
            <not>
              <property>autopilot/locks/back-course</property>
            </not>
          </and>
        </condition>
        <property>instrumentation/nav/heading-needle-deflection</property>
      </input>
      <input>
        <condition>
          <and>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV2</value>
            </equals>
            <not>
              <property>autopilot/locks/back-course</property>
            </not>
          </and>
        </condition>
        <property>instrumentation/nav[1]/heading-needle-deflection</property>
      </input>
      <input>
        <condition>
          <and>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV1</value>
            </equals>
            <property>autopilot/locks/back-course</property>
          </and>
        </condition>
        <property>instrumentation/nav/heading-needle-deflection</property>
        <scale>-1</scale>
      </input>
      <input>
        <condition>
          <and>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV2</value>
            </equals>
            <property>autopilot/locks/back-course</property>
          </and>
        </condition>
        <property>instrumentation/nav[1]/heading-needle-deflection</property>
        <scale>-1</scale>
      </input>
      <reference>0</reference>
      <output>autopilot/internal/course-deflection</output>
    </filter>

    <pid-controller>
        <name>ROLL hold</name>
        <debug>false</debug>
        <enable>
          <property>autopilot/locks/heading</property>
          <value>ROLL</value>
        </enable>
        <input>orientation/roll-deg</input>
        <reference>autopilot/settings/target-roll-deg</reference>
        <output>autopilot/internal/roll-filter</output>
        <config>
            <Kp>0.5</Kp>
            <beta>1.0</beta>
            <alpha>0.1</alpha>
            <gamma>0.0</gamma>
            <Ti>1.0</Ti>
            <Td>0.00001</Td>
            <min>-30</min>
            <max>30</max>
        </config>
    </pid-controller>

    <pi-simple-controller>
        <name>Heading Bug Hold</name>
        <debug>false</debug>
        <enable>
          <property>autopilot/locks/heading</property>
          <value>HDG</value>
        </enable>
        <input>autopilot/internal/heading-bug-error-deg</input>
        <reference>0.0</reference>
        <output>autopilot/internal/roll-filter</output>
        <config>
            <Kp>-1.5</Kp>
            <Ki>0.0</Ki>
            <min>
                <property>autopilot/settings/bank-limit</property>
                <scale>-1</scale>
            </min>
            <max>
                <property>autopilot/settings/bank-limit</property>
            </max>
        </config>
    </pi-simple-controller>

    <pi-simple-controller>
        <name>VOR</name>
        <debug>false</debug>
        <enable>
          <condition>
            <equals>
    		      <property>autopilot/locks/heading</property>
    		      <value>VOR</value>
            </equals>
          </condition>
        </enable>
        <input>autopilot/internal/nav-heading-error-deg</input>
        <reference>0.0</reference>
        <output>autopilot/internal/roll-filter</output>
        <config>
            <Kp>-1.5</Kp>
            <Ki>0.0</Ki>
            <min>
              <property>autopilot/settings/bank-limit</property>
              <scale>-1</scale>
            </min>
            <max>
              <property>autopilot/settings/bank-limit</property>
            </max>
        </config>
    </pi-simple-controller>

    <pi-simple-controller>
        <name>LOC</name>
        <debug>false</debug>
        <enable>
          <condition>
            <equals>
	            <property>autopilot/locks/heading</property>
	            <value>LOC</value>
            </equals>
          </condition>
        </enable>
        <input>autopilot/internal/nav-heading-error-deg</input>
        <reference>0.0</reference>
        <output>autopilot/internal/roll-filter</output>
        <config>
            <Kp>-1.5</Kp> <!-- old -1.5 -->
            <Ki>0.0</Ki> <!-- old 0 -->
            <min>
              <property>autopilot/settings/bank-limit</property>
              <scale>-1</scale>
            </min>
            <max>
              <property>autopilot/settings/bank-limit</property>
            </max>
        </config>
    </pi-simple-controller>

    <pi-simple-controller>
        <name>Lnav</name>
        <debug>false</debug>
        <enable>
				    <property>autopilot/locks/heading</property>
				    <value>LNAV</value>
        </enable>
        <input>autopilot/internal/course-offset</input>
        <reference>0.0</reference>
        <output>autopilot/internal/roll-filter</output>
        <config>
            <Kp>-1.5</Kp>
            <Ki>0</Ki>
            <min>
              <property>autopilot/settings/bank-limit</property>
              <scale>-1</scale>
            </min>
            <max>
              <property>autopilot/settings/bank-limit</property>
            </max>
        </config>
    </pi-simple-controller>

    <filter>
        <name>Roll command</name>
        <debug>false</debug>
        <feedback-if-disabled>true</feedback-if-disabled>
        <initialize-to>output</initialize-to>
        <enable>
           <property>autopilot/locks/FD-status</property>
        </enable>
        <input>autopilot/internal/roll-filter</input>
        <output>autopilot/internal/roll-bars</output>
        <type>noise-spike</type>
        <max-rate-of-change>7</max-rate-of-change>
    </filter>

    <pid-controller>
        <name>Aileron Control</name>
        <debug>false</debug>
        <enable>
          <property>autopilot/locks/AP-status</property>
          <value>AP</value>
        </enable>
        <input>orientation/roll-deg</input>
        <reference>autopilot/internal/roll-bars</reference>
        <output>controls/flight/aileron</output>
        <config>
            <Kp>0.50</Kp>
            <beta>1.0</beta>
            <alpha>0.1</alpha>
            <gamma>0.0</gamma>
            <Ti>10.0</Ti>
            <Td>0.00001</Td>
            <min>-1</min>
            <max>1</max>
        </config>
    </pid-controller>

<!-- ======= Vertical Modes ======= -->

    <filter>
        <name>pitch control</name>
        <debug>false</debug>
        <feedback-if-disabled>true</feedback-if-disabled>
        <initialize-to>output</initialize-to>
        <enable>
          <property>autopilot/locks/altitude</property>
          <value>PTCH</value>
        </enable>
        <input>autopilot/settings/target-pitch-deg</input>
        <output>autopilot/internal/pitch-filter</output>
        <type>noise-spike</type>
        <max-rate-of-change>10.0</max-rate-of-change>
    </filter>

    <pid-controller>
        <name>Altitude Hold 1</name>
        <debug>false</debug>
        <enable>
          <property>/autopilot/locks/altitude</property>
          <value>ALT</value>
        </enable>
        <input>instrumentation/altimeter/indicated-altitude-ft</input>
        <reference>
						<property>autopilot/settings/asel</property>
            <scale>100</scale>
        </reference>
        <output>autopilot/internal/target-climb-rate-fps</output>
        <config>
            <Kp>0.25</Kp> <!--origin = 0.25-->
            <beta>1.0</beta>
            <alpha>0.1</alpha>
            <gamma>0.0</gamma>
            <Ti>15.0</Ti> <!-- origin 10.0 -->
            <Td>0.000001</Td>
            <min>-40</min> <!-- origin -30 -->
            <max>66</max> <!-- origin = 66-->
        </config>
    </pid-controller>

    <pi-simple-controller>
        <name>Altitude 2</name>
        <debug>false</debug>
        <enable>
          <property>/autopilot/locks/altitude</property>
          <value>ALT</value>
        </enable>
	      <input>velocities/vertical-speed-fps</input>
        <reference>autopilot/internal/target-climb-rate-fps</reference>
        <output>autopilot/internal/pitch-filter</output>
        <config>
            <Kp>0.20</Kp> 	<!-- origin 0.15 -->
            <Ki>0.0</Ki>		<!-- origin 0.0 -->
            <min>-30</min> 	<!-- origin -20 -->
            <max>30</max>		<!-- origin 20 -->
        </config>
    </pi-simple-controller>

    <pid-controller>
        <name>Vnav 1</name>
        <debug>false</debug>
        <enable>
          <condition>
            <and>
              <equals>
                <property>autopilot/locks/altitude</property>
                <value>VALT</value>
              </equals>
              <not>
                <property>autopilot/locks/fms-gs</property>
              </not>
              <not>
                <property>autopilot/locks/fms-app</property>
              </not>
            </and>
          </condition>
        </enable>
        <input>instrumentation/altimeter/indicated-altitude-ft</input>
        <reference>autopilot/settings/target-altitude-ft</reference>
        <output>autopilot/internal/target-climb-rate-fps</output>
        <config>
            <Kp>0.25</Kp> <!--origin = 0.25-->
            <beta>1.0</beta>
            <alpha>0.1</alpha>
            <gamma>0.0</gamma>
            <Ti>10.0</Ti> <!-- origin 10.0 -->
            <Td>0.000001</Td>
            <min>
              <property>autopilot/settings/fps-limit</property>
            </min>
            <max>70</max>
        </config>
    </pid-controller>

    <pid-controller>
        <name>Vapp</name>
        <debug>false</debug>
        <enable>
          <condition>
            <and>
              <equals>
                <property>autopilot/locks/altitude</property>
                <value>VALT</value>
              </equals>
              <not>
                <property>autopilot/locks/fms-gs</property>
              </not>
              <property>autopilot/locks/fms-app</property>
            </and>
          </condition>
        </enable>
        <input>instrumentation/altimeter/indicated-altitude-ft</input>
<!--        <input>instrumentation/gps/indicated-altitude-ft</input>-->
        <reference>autopilot/settings/target-altitude-ft</reference>
        <output>autopilot/internal/target-climb-rate-fps</output>
        <config>
            <Kp>0.25</Kp> <!--origin = 0.25-->
            <beta>1.0</beta>
            <alpha>0.1</alpha>
            <gamma>0.0</gamma>
            <Ti>10.0</Ti> <!-- origin 10.0 -->
            <Td>0.000001</Td>
            <min>
              <property>autopilot/settings/fps-limit</property>
            </min>
            <max>70</max>
        </config>
    </pid-controller>

    <pi-simple-controller>
        <name>Vnav 2</name>
        <debug>false</debug>
        <enable>
          <condition>
            <and>
              <equals>
                <property>/autopilot/locks/altitude</property>
                <value>VALT</value>
              </equals>
              <not>
                <property>autopilot/locks/fms-gs</property>
              </not>
<!--              <not>
                <property>autopilot/locks/fms-app</property>
              </not>
-->            </and>
          </condition>
        </enable>
        <input>velocities/vertical-speed-fps</input>
        <reference>autopilot/internal/target-climb-rate-fps</reference>
        <output>autopilot/internal/pitch-filter</output>
        <config>
            <Kp>0.5</Kp> 	<!-- origin 0.30 -->
            <Ki>0.0</Ki>		<!-- origin 0.0 -->
            <min>-30</min> 	<!-- origin -20 -->
            <max>30</max>		<!-- origin 20 -->
        </config>
    </pi-simple-controller>
<!--
    <pi-simple-controller>
        <name>Fms App</name>
        <debug>false</debug>
        <enable>
          <condition>
            <and>
              <equals>
                <property>/autopilot/locks/altitude</property>
                <value>VALT</value>
              </equals>
              <not>
                <property>autopilot/locks/fms-gs</property>
              </not>
              <property>autopilot/locks/fms-app</property>
            </and>
          </condition>
        </enable>
        <input>velocities/vertical-speed-fps</input>
        <reference>
          <property>autopilot/internal/target-climb-rate-fps</property>
          <scale>0.9</scale>
        </reference>
        <output>autopilot/internal/pitch-filter</output>
        <config>
            <Kp>1.0</Kp> 
            <Ki>0.0</Ki>
            <min>-30</min>
            <max>30</max>
        </config>
    </pi-simple-controller>
-->
    <pid-controller>
        <name>Vertical Speed Hold</name>
        <debug>false</debug>
        <enable>
            <property>/autopilot/locks/altitude</property>
            <value>VS</value>
        </enable>
        <input>autopilot/internal/vert-speed-fpm</input>
        <reference>autopilot/settings/vertical-speed-fpm</reference>
        <output>autopilot/internal/pitch-filter</output>
        <config>
            <Kp>0.015</Kp>
            <beta>1.0</beta>
            <alpha>0.1</alpha>
            <gamma>0.0</gamma>
            <Ti>10.0</Ti>
            <Td>0.1</Td>
            <min>-5</min>
            <max>20</max>
        </config>
    </pid-controller>

    <pid-controller>
      <name>flc kt</name>
      <debug>false</debug>
      <enable>
        <condition>
					<and>
            <or>
              <equals>
                  <property>/autopilot/locks/altitude</property>
                  <value>FLC</value>
              </equals>
              <equals>
                  <property>/autopilot/locks/altitude</property>
                  <value>VFLC</value>
              </equals>
            </or>
						<less-than>
							<property>instrumentation/altimeter/indicated-altitude-ft</property>								
							<value>30650</value>
						</less-than>
					</and>
        </condition>
      </enable>
      <input>instrumentation/airspeed-indicator/indicated-speed-kt</input>
      <reference>autopilot/settings/target-speed-kt</reference>
      <output>
				<property>controls/engines/engine[0]/throttle</property>
				<property>controls/engines/engine[1]/throttle</property>		
      </output>
      <config>
        <Kp>0.05</Kp>
        <beta>1.0</beta>
        <alpha>0.1</alpha>
        <gamma>0.0</gamma>
        <Ti>10</Ti>
        <Td>0.001</Td>
        <min>0.0</min>
        <max>0.95</max>
      </config>
    </pid-controller>

    <pid-controller>
      <name>flc mach</name>
      <debug>false</debug>
      <enable>
        <condition>
					<and>
            <or>
                <equals>
                    <property>/autopilot/locks/altitude</property>
                    <value>FLC</value>
                </equals>
                <equals>
                    <property>/autopilot/locks/altitude</property>
                    <value>VFLC</value>
                </equals>
            </or>
						<greater-than-equals>
							<property>instrumentation/altimeter/indicated-altitude-ft</property>								
							<value>30650</value>
						</greater-than-equals>
					</and>
        </condition>
      </enable>
      <input>instrumentation/airspeed-indicator/indicated-mach</input>
      <reference>autopilot/settings/target-speed-mc</reference>
      <output>
				<property>controls/engines/engine[0]/throttle</property>
				<property>controls/engines/engine[1]/throttle</property>		
      </output>
      <config>
        <Kp>10</Kp> <!-- old 0.05 -->
        <beta>1.0</beta>
        <alpha>0.1</alpha>
        <gamma>0.0</gamma>
        <Ti>10</Ti>   <!-- old 10 -->
        <Td>0.001</Td> <!-- old 0.001 -->
        <min>0.0</min>
        <max>0.95</max>
      </config>
    </pid-controller>

    <pid-controller>
        <name>flc 2</name>
        <debug>false</debug>
        <enable>
            <condition>
                <or>
                    <equals>
                        <property>/autopilot/locks/altitude</property>
                        <value>FLC</value>
                    </equals>
                    <equals>
                        <property>/autopilot/locks/altitude</property>
                        <value>VFLC</value>
                    </equals>
                </or>
            </condition>
        </enable>
        <input>instrumentation/altimeter/indicated-altitude-ft</input>
        <reference>
						<property>autopilot/settings/asel</property>
            <scale>100</scale>
        </reference>
        <output>autopilot/internal/target-climb-rate-fps</output>
        <config>
            <Kp>0.20</Kp>
            <beta>1.0</beta>
            <alpha>0.1</alpha>
            <gamma>0.0</gamma>
            <Ti>10.0</Ti> 
            <Td>0.000001</Td>
            <min>-45</min>
            <max>65</max>
        </config>
    </pid-controller>

    <pi-simple-controller>
        <name>flc 3</name>
        <debug>false</debug>
        <enable>
            <condition>
                <or>
                    <equals>
                        <property>/autopilot/locks/altitude</property>
                        <value>FLC</value>
                    </equals>
                    <equals>
                        <property>/autopilot/locks/altitude</property>
                        <value>VFLC</value>
                    </equals>
                </or>
            </condition>
        </enable>
        <input>velocities/vertical-speed-fps</input>
        <reference>autopilot/internal/target-climb-rate-fps</reference>
        <output>autopilot/internal/pitch-filter</output>
        <config>
            <Kp>0.30</Kp>
            <Ki>0.0</Ki>
            <min>-30</min>
            <max>30</max>
        </config>
    </pi-simple-controller>

    <filter>
        <name>pitch command</name>
        <debug>false</debug>
        <feedback-if-disabled>true</feedback-if-disabled>
        <initialize-to>output</initialize-to>
        <enable>autopilot/locks/FD-status</enable>
        <input>autopilot/internal/pitch-filter</input>
        <output>autopilot/internal/pitch-bars</output>
        <type>noise-spike</type>
        <max-rate-of-change>5.0</max-rate-of-change>
    </filter>

    <pid-controller>
        <name>Elevator Trim Control</name>
        <debug>false</debug>
        <enable>
          <property>autopilot/locks/AP-status</property>
          <value>AP</value>
        </enable>
        <input>orientation/pitch-deg</input>
        <reference>autopilot/internal/pitch-bars</reference>
        <output>controls/flight/elevator-trim</output>
        <config>
            <Kp>-0.015</Kp> 
            <beta>1.0</beta>
            <alpha>0.1</alpha>
            <gamma>0.0</gamma>
            <Ti>10.0</Ti>	
            <Td>0.01</Td> 
            <min>-1</min>
            <max>1</max>
        </config>
    </pid-controller>

<!-- Glide Slope -->

    <filter>
        <name>nav1 gs deflection</name>
        <debug>false</debug>
        <feedback-if-disabled>true</feedback-if-disabled>
        <initialize-to>output</initialize-to>
        <enable>
          <condition>
              <or>
                <equals>
                  <property>autopilot/settings/nav-source</property>
                  <value>NAV1</value>
                </equals>
                <equals>
                  <property>autopilot/settings/nav-source</property>
                  <value>FMS1</value>
                </equals>
              </or>
          </condition>
        </enable>
        <input>instrumentation/nav/gs-needle-deflection-norm</input>
        <output>autopilot/internal/gs-deflection</output>
        <type>noise-spike</type>
        <max-rate-of-change>10</max-rate-of-change>
    </filter>

    <filter>
      <name>nav1 gs rate</name>
      <debug>false</debug>
      <type>gain</type>
      <gain>1.0</gain>
      <enable>
        <condition>
          <equals>
            <property>autopilot/settings/nav-source</property>
            <value>NAV1</value>
          </equals>
        </condition>
      </enable>
      <input>instrumentation/nav/gs-rate-of-climb</input>
      <output>autopilot/internal/gs-rate-fps</output>
    </filter>

    <filter>
        <name>nav2 gs deflection</name>
        <debug>false</debug>
        <feedback-if-disabled>true</feedback-if-disabled>
        <initialize-to>output</initialize-to>
        <enable>
          <condition>
              <or>
                <equals>
                  <property>autopilot/settings/nav-source</property>
                  <value>NAV2</value>
                </equals>
                <equals>
                  <property>autopilot/settings/nav-source</property>
                  <value>FMS2</value>
                </equals>
              </or>
          </condition>
        </enable>
        <input>instrumentation/nav[1]/gs-needle-deflection-norm</input>
        <output>autopilot/internal/gs-deflection</output>
        <type>noise-spike</type>
        <max-rate-of-change>10</max-rate-of-change>
    </filter>

    <filter>
        <name>nav2 gs rate</name>
        <debug>false</debug>
        <feedback-if-disabled>true</feedback-if-disabled>
        <initialize-to>output</initialize-to>
        <enable>
          <condition>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>NAV2</value>
            </equals>
          </condition>
        </enable>
        <input>instrumentation/nav[1]/gs-rate-of-climb</input>
        <output>autopilot/internal/gs-rate-fps</output>
        <type>noise-spike</type>
        <max-rate-of-change>10</max-rate-of-change>
    </filter>

    <pi-simple-controller>
        <name>FMS-GS</name>
        <debug>false</debug>
        <enable>
          <condition>
            <equals>
              <property>autopilot/settings/nav-source</property>
              <value>FMS1</value>
            </equals>
          </condition>
        </enable>
        <input>velocities/vertical-speed-fps</input>
        <reference>autopilot/internal/fms-climb-rate-fps</reference>
        <output>autopilot/internal/pitch-filter</output>
        <config>
            <Kp>1.5</Kp>
            <Ki>0.0</Ki> 
            <Td>0.000001</Td>
            <min>-15</min>
            <max>15</max>
        </config>
    </pi-simple-controller>

    <pi-simple-controller>
        <name>GS</name>
        <debug>false</debug>
        <enable>
          <condition>
            <and>
              <equals>
                <property>/autopilot/locks/altitude</property>
                <value>GS</value>
              </equals>
              <not>
                <property>/autopilot/locks/fms-gs</property>
              </not>
            </and>
          </condition>
        </enable>
        <input>velocities/vertical-speed-fps</input>
        <reference>autopilot/internal/gs-rate-fps</reference>
        <output>autopilot/internal/pitch-filter</output>
        <config>
            <Kp>1.5</Kp> <!-- old 1.5 -->
            <Ki>0.0</Ki> <!-- old 0 -->
            <min>-15.0</min> <!-- old -30.0 -->
            <max>15.0</max>	<!-- old 15.0 -->
        </config>
    </pi-simple-controller>

<!-- Speed Control  -->

    <pid-controller>
      <name>Speed Control kt</name>
      <debug>false</debug>
			<enable>
				<condition>
					<and>
						<equals>
							<property>/autopilot/locks/AP-status</property>
								<value>AP</value>
						</equals>
						<not>
							<property>autopilot/locks/alt-mach</property>
						</not>
						<or>
							<and>
                <property>autopilot/settings/fms</property>
								<or>
									<equals>
										<property>/autopilot/locks/altitude</property>
										<value>VALT</value>
									</equals>
									<equals>
										<property>/autopilot/locks/altitude</property>
										<value>GS</value>
									</equals>
								</or>
							</and>
							<property>/autopilot/locks/speed</property>
						</or>
					</and>
				</condition>
			</enable>
			<input>instrumentation/airspeed-indicator/indicated-speed-kt</input>
			<reference>autopilot/settings/target-speed-kt</reference>
			<output>
				<property>controls/engines/engine[0]/throttle</property>
				<property>controls/engines/engine[1]/throttle</property>		
			</output>
      <config>
        <Kp>0.1</Kp> <!-- old 0.1 -->
        <beta>1.0</beta>
        <alpha>0.1</alpha>
        <gamma>0.0</gamma>
        <Ti>5.0</Ti>	<!-- old 10.0 -->
        <Td>0.001</Td>
        <min>0.0</min>
        <max>0.95</max>
      </config>
    </pid-controller>

    <pid-controller>
        <name>Speed Control mc</name>
        <debug>false</debug>
				<enable>
					<condition>
					<and>
						<equals>
							<property>/autopilot/locks/AP-status</property>
								<value>AP</value>
						</equals>
							<property>autopilot/locks/alt-mach</property>
						<or>
							<and>
                <property>autopilot/settings/fms</property>
								<or>
									<equals>
										<property>/autopilot/locks/altitude</property>
										<value>VALT</value>
									</equals>
									<equals>
										<property>/autopilot/locks/altitude</property>
										<value>GS</value>
									</equals>
								</or>
							</and>
							<property>/autopilot/locks/speed</property>
						</or>
					</and>
					</condition>
				</enable>
				<input>instrumentation/airspeed-indicator/indicated-mach</input>
				<reference>autopilot/settings/target-speed-mc</reference>
				<output>
					<property>controls/engines/engine[0]/throttle</property>
					<property>controls/engines/engine[1]/throttle</property>		
				</output>
        <config>
          <Kp>5</Kp> <!-- old 10 -->
          <beta>1.0</beta>
          <alpha>0.1</alpha>
          <gamma>0.0</gamma>
          <Ti>10.0</Ti>	<!-- old 10.0 -->
          <Td>0.001</Td>
          <min>0.0</min>
          <max>0.95</max>
        </config>
    </pid-controller>

<!-- Bearing -->

    <pi-simple-controller>
      <name>NAV1 bearing </name>
      <debug>false</debug>
      <enable>
        <prop>/instrumentation/primus2000/sc840/nav1ptr</prop>
        <value>1</value>
      </enable>
      <input>orientation/heading-deg</input>
			<reference>instrumentation/nav/heading-deg</reference>
			<output>autopilot/internal/nav1-pointer</output>
			<config>
				<Kp>1</Kp>
				<Ki>0.0</Ki>
				<min>-360</min>
				<max>360.0</max>
			</config>
		</pi-simple-controller>

	  <pi-simple-controller>
      <name>NAV2 bearing </name>
      <debug>false</debug>
      <enable>
          <prop>/instrumentation/primus2000/sc840/nav2ptr</prop>
          <value>1</value>
      </enable>
      <input>orientation/heading-deg</input>
		  <reference>instrumentation/nav[1]/heading-deg</reference>
		  <output>autopilot/internal/nav2-pointer</output>
		  <config>
		    <Kp>1</Kp>
		    <Ki>0.0</Ki>
		    <min>-360</min>
		    <max>360</max>
		  </config>
	  </pi-simple-controller>

	  <filter>
      <name>ADF1 bearing</name>
      <debug>false</debug>
      <feedback-if-disabled>false</feedback-if-disabled>
      <initialize-to>input</initialize-to>
      <enable>
        <property>/instrumentation/primus2000/sc840/nav1ptr</property>
        <value>2</value>
      </enable>
      <input>instrumentation/adf/indicated-bearing-deg</input>
      <output>/autopilot/internal/nav1-pointer</output>
      <type>noise-spike</type>
      <max-rate-of-change>90</max-rate-of-change>
	  </filter>

	  <filter>
      <name>ADF2 bearing</name>
      <debug>false</debug>
      <feedback-if-disabled>false</feedback-if-disabled>
      <initialize-to>input</initialize-to>
      <enable>
        <property>/instrumentation/primus2000/sc840/nav2ptr</property>
        <value>2</value>
      </enable>
      <input>instrumentation/adf[1]/indicated-bearing-deg</input>
      <output>/autopilot/internal/nav2-pointer</output>
      <type>noise-spike</type>
      <max-rate-of-change>90</max-rate-of-change>
	  </filter>

	  <pi-simple-controller>
      <name>FMS1 bearing </name>
      <debug>false</debug>
      <enable>
          <prop>/instrumentation/primus2000/sc840/nav1ptr</prop>
          <value>3</value>
      </enable>
      <input>orientation/heading-magnetic-deg</input>
      <reference>instrumentation/gps/wp/wp[1]/bearing-mag-deg</reference>
      <output>autopilot/internal/nav1-pointer</output>
      <config>
          <Kp>1</Kp>
          <Ki>0.01</Ki>
          <min>-360</min>
          <max>360</max>
      </config>
	  </pi-simple-controller>

	  <pi-simple-controller>
      <name>FMS2 bearing </name>
      <debug>false</debug>
      <enable>
          <prop>/instrumentation/primus2000/sc840/nav2ptr</prop>
          <value>3</value>
      </enable>
      <input>orientation/heading-magnetic-deg</input>
      <reference>instrumentation/gps/wp/wp[1]/bearing-mag-deg</reference>
      <output>autopilot/internal/nav2-pointer</output>
      <config>
          <Kp>1</Kp>
          <Ki>0.01</Ki>
          <min>-360</min>
          <max>360</max>
      </config>
	  </pi-simple-controller>

<!-- Elevator Controls -->

    <filter>
      <name>Elevator Control</name>
      <type>noise-spike</type>
      <debug>false</debug>
      <max-rate-of-change>
        <condition>
          <equals>
            <property>autopilot/locks/AP-status</property>
            <value>AP</value>
          </equals>
        </condition>
        <value>0.01</value>
        </max-rate-of-change>
        <max-rate-of-change>100.0</max-rate-of-change>
        <input>
          <condition>
            <equals>
              <property>autopilot/locks/AP-status</property>
               	<value>AP</value>
            </equals>
          </condition>
          <value>0</value>
        </input>
        <input>controls/flight/elevator</input>
        <output>autopilot/internal/elevator-cmd-norm</output>
			</filter>

			<filter>
					<name>Elevator Output</name>
					<type>gain</type>
					<gain>1.0</gain>
					<enable>
						<condition>
              <equals>
                <property>autopilot/locks/AP-status</property>
                <value>AP</value>
              </equals>
						</condition>
		      </enable>
					<input>autopilot/internal/elevator-cmd-norm</input>
					<output>controls/flight/elevator</output>
       </filter>

</PropertyList>

